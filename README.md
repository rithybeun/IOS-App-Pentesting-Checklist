<a href='#' target="_blank"><img alt='iOS' src='https://img.shields.io/badge/iOS_Checklist-grey?style=flat-square&logo=Apple&logoColor=white&labelColor=black&color=grey'/></a>
<a href='#' target="_blank"><img alt='iOS' src='https://img.shields.io/badge/IOS-grey.svg?style=flat-square&logo=Apple&labelColor=black&logoColor=fff'/></a>

# IOS App Pentesting Checklist

**Welcome to the "IOS App Penetration Testing Checklist" Repository!**

Explore the ultimate companion for IOSapp penetration testing, meticulously crafted to identify vulnerabilities in network, data, storage, and permissions effortlessly. This repository merges a comprehensive checklist of tasks and cutting-edge techniques, providing security professionals with a robust framework for a thorough security assessment of IOS applications.

The checklist covers a range of topics, including:

**Static analysis:** reviewing the app's source code and resources for potential vulnerabilities

**Dynamic analysis:** analyzing the app's behavior and interactions with the device and network during runtime

**Network analysis:** analyzing the app's communication with servers and other external resources over the network

**Permission analysis:** reviewing the app's requested permissions and assessing whether they are appropriate and secure

**Cryptographic analysis:** reviewing the app's use of cryptography and ensuring that it is implemented securely

**Data storage analysis:** analyzing the app's handling of sensitive data, including how it is stored and transmitted

This checklist is intended as a starting point for penetration testers and bug bounty hunters to identify common security issues in IOS applications. It is not a comprehensive guide to all possible security issues and should be used in conjunction with other resources and best practices.

## Table of Content

- [Important Tools](#important-tools)
- [Tools Installation](#Tools-Installation)


## Important Tools

- Mobile Security Framework (MobSF) [(Link)](https://github.com/MobSF/Mobile-Security-Framework-MobSF)
- Runtime Mobile Security (RMS) [(Link)](https://github.com/m0bilesecurity/RMS-Runtime-Mobile-Security)
- Burp Suite [(Link)](https://portswigger.net/burp)
- Postman [(Link)](https://www.postman.com) `for API's`
- Radare2 [(Link)](https://github.com/radareorg/radare2)
- Objection [(Link)](https://github.com/sensepost/objection)
- Frida [(Link)](https://frida.re)
- Grapefruit [(Link)](https://github.com/ChiChou/grapefruit)
- ios-deploy [(Link)](https://github.com/ios-control/ios-deploy)
- SSL Kill Switch 2 [(Link)](https://github.com/nabla-c0d3/ssl-kill-switch2)
- SwiftShield [(Link)](https://github.com/rockbruno/swiftshield)
- optool [(Link)](https://github.com/alexzielenski/optool)
- BinaryCookieReader [(Link)](https://github.com/as0ler/BinaryCookieReader/tree/master)
- r2flutch [(Link)](https://github.com/as0ler/r2flutch)
- nm - iOS  [(Link)](https://www.manpagez.com/man/1/nm/osx-10.12.6.php)
- Frida for iOS [(Link)](https://github.com/frida/frida)
- Plutil  [(Link)](https://www.theiphonewiki.com/wiki/Plutil)
- dsdump [(Link)](https://github.com/DerekSelander/dsdump)
- Cydia
- iOSbackup [(Link)](https://github.com/avibrazil/iOSbackup) 
- MachoOView [(Link)](https://sourceforge.net/projects/machoview/)
- Usbmuxd [(Link)](https://github.com/libimobiledevice/usbmuxd)
- iProxy [(Link)](https://github.com/tcurdt/iProxy)
- simctl
- class-dump
- radare2 for iOS [(Link)](https://github.com/radare/radare2)
- xcrun  [(Link)](https://www.manpagez.com/man/1/xcrun/)
- Keychain-Dumper https://github.com/mechanico/Keychain-Dumper 
- Cycript https://www.cycript.org/
- Sileo https://cydia-app.com/sileo/
- lldb https://lldb.llvm.org/
- class-dump-dyld https://github.com/limneos/classdump-dyld
- security https://ss64.com/osx/security.html
- Frida-ios-dump https://github.com/AloneMonkey/frida-ios-dump
- otool
- Xcode
- swift-demangle
- gdb
- Xcode Command Line Tools

#Tools-Installation

**Grapefruit Installation**


Grapefruit is an IOS app assessment tools that is using the FRIDA server on the iOS Device and is abstracting many penetration testing tasks in to a Web UI. It can be installed via npm.

```bash
npm install -g igf


grapefruit

```
With Grapefruit it's possible to explore different kinds of information concerning an iOS app. Once you selected the iOS app you can perform many tasks such as:
- Get information about the binary
- View folders and files used by the application and download them
- Inspect the Info.plist
- Get a UI Dump of the app screen shown on the iOS device
- List the modules that are loaded by the app
- Dump class names
- Dump keychain items

**ios-deploy Installation**


With ios-deploy you can install and debug iOS apps from the command line, without using Xcode. It can be installed via brew on macOS:

```bash
brew install ios-deploy
```
Alternatively:
```bash
git clone https://github.com/ios-control/ios-deploy.git
cd ios-deploy/
xcodebuild
cd build/Release
./ios-deploy
ln -s <your-path-to-ios-deploy>/build/Release/ios-deploy /usr/local/bin/ios-deploy
```
The last line creates a symbolic link and makes the executable available system-wide. Reload your shell to make the new commands available:
```bash
zsh: # . ~/.zshrc
bash: # . ~/.bashrc
```


**SwiftShield Installation**

SwiftShield ↗ is a tool that generates irreversible, encrypted names for your iOS project's objects (including your Pods and Storyboards). This raises the bar for reverse engineers and will produce less helpful output when using reverse engineering tools such as class-dump and Frida.

A sample Swift project is used to demonstrate the usage of SwiftShield.

Check out [(sushi2k/SwiftSecurity ↗.)](https://github.com/sushi2k/SwiftSecurity)
Open the project in Xcode and make sure that the project is building successfully (Product / Build or Apple-Key + B).
[(Download ↗)](https://github.com/rockbruno/swiftshield/releases) the latest release of SwiftShield and unzip it.
Go to the directory where you downloaded SwiftShield and copy the swiftshield executable to /usr/local/bin:

```bash
cp swiftshield/swiftshield /usr/local/bin/
```
In your terminal go into the SwiftSecurity directory (which you checked out in step 1) and execute the command swiftshield (which you downloaded in step 3):
```bash
$ cd SwiftSecurity
$ swiftshield -automatic -project-root . -automatic-project-file SwiftSecurity.xcodeproj -automatic-project-scheme SwiftSecurity
```
SwiftShield is now detecting class and method names and is replacing their identifier with an encrypted value.

In the original source code you can see all the class and method identifiers:

![image](https://github.com/rithybeun/IOS-App-Pentesting-Checklist/assets/74963884/0d90a7df-d55a-46ac-a116-3a9b6977598b)


SwiftShield was now replacing all of them with encrypted values that leave no trace to their original name or intention of the class/method:


![image](https://github.com/rithybeun/IOS-App-Pentesting-Checklist/assets/74963884/13c1b54c-e718-465b-9fdc-79aeca4b8154)


**optool Installation**

optool ↗ is a tool which interfaces with MachO binaries in order to insert/remove load commands, strip code signatures, resign, and remove aslr.

To install it:
```bash
git clone https://github.com/alexzielenski/optool.git
cd optool/
git submodule update --init --recursive
xcodebuild
ln -s <your-path-to-optool>/build/Release/optool /usr/local/bin/optool
```

The last line creates a symbolic link and makes the executable available system-wide. Reload your shell to make the new commands available:


```bash
zsh: # . ~/.zshrc
bash: # . ~/.bashrc
```


**BinaryCookieReader Installation**

A tool to dump all the cookies from the binary Cookies.binarycookies file 

```bash
Python BinaryCookieReader.py [Cookie.binarycookies-file-path]

https://github.com/as0ler/BinaryCookieReader/blob/master/BinaryCookieReader.py
```


**nm Installation**

nm is a tool that displays the name list (symbol table) of the given binary. You can find here more information for for iOS.

**Frida on iOS Installation**
Installing Frida on iOS

Start Cydia and add Frida's repository by navigating to Manage -> Sources -> Edit -> Add and entering https://build.frida.re ↗. You should then be able to find and install the Frida package.

```bash
$ frida-ps -U
PID  Name
---  ----------------
963  Mail
952  Safari
416  BTServer
422  BlueTool
791  CalendarWidget
451  CloudKeychainPro
239  CommCenter
764  ContactsCoreSpot
```

**Frida on iOS Installation**

Install Xcode Command Line Tools: plutil is part of the Xcode Command Line Tools package. You can install it by running the following command in Terminal:

```bash
xcode-select --install
```
```bash
plutil -p file_name.plist
```

**Frida on iOS Installation**
iOSbackup is a Python 3 class that reads and extracts files from a password-encrypted iOS backup created by iTunes on Mac and Windows.

```bash
pip3 install iOSbackup --user
```
**iOSbackup Installatio**


iOSbackup requires other two packages: biplist and pycryptodome that will be installed automatically by pip.

pycryptodome has an API compatible with older pycrypto, which should also work with iOSbackup. But pycryptodome is more well maintained and easier to install on Windows and macOS.


**Usage**
```bash
>>> from iOSbackup import iOSbackup

>>> iOSbackup.getDeviceList()
[{'udid': '00456030-000E4412342802E',
  'name': 'mobileavi',
  'ios': '13.2.3',
  'serial': 'DNPPQRS0N4RW',
  'type': 'iPhone12,3',
  'encrypted': True},
{'udid': '00654030-01234412342802E',
  'name': 'ipad',
  'ios': '13.1.3',
  'serial': 'DABCRS0N4RW',
  'type': 'iPad10,1',
  'encrypted': True}]
```
**usbmuxd Installatio**


usbmuxd is a socket daemon that monitors USB iPhone connections. You can use it to map the mobile device's localhost listening sockets to TCP ports on your host computer. This allows you to conveniently SSH into your iOS device without setting up an actual network connection. When usbmuxd detects an iPhone running in normal mode, it connects to the phone and begins relaying requests that it receives via /var/run/usbmuxd.

Debian / Ubuntu Linux

First install all required dependencies and build tools:


```bash
sudo apt-get install \
	build-essential \
	pkg-config \
	checkinstall \
	git \
	autoconf \
	automake \
	libtool-bin \
	libplist-dev \
	libusbmuxd-dev \
	libimobiledevice-dev \
	libimobiledevice-glue-dev \
	libusb-1.0-0-dev \
	udev

```

If systemd is not installed and should control spawning the daemon use:


```bash
sudo apt-get install \
	systemd
```

Then clone the actual project repository:

```bash
git clone https://github.com/libimobiledevice/usbmuxd.git
cd usbmuxd
```

Now you can build and install it:


```bash
./autogen.sh
make
sudo make install
```


If you require a custom prefix or other option being passed to ./configure you can pass them directly to ./autogen.sh like this:
```bash
./autogen.sh --prefix=/opt/local --without-preflight --without-systemd
make
sudo make install
```


To output a list of available configure options use:
```bash
./autogen.sh --help
```
OR 

```bash
submuxd --help
man 

```

**class-dump Installatio**


class-dump by Steve Nygard is a command line utility for examining the Objective-C runtime information stored in Mach-O (Mach object) files. It generates declarations for the classes, categories, and protocols.
```bash
[submuxd](http://stevenygard.com/projects/class-dump/)
http://stevenygard.com/download/class-dump-3.5.dmg
```


** Radare2 Installation **


Radare2 ↗ is a complete framework for reverse-engineering and analyzing binaries. The installation instructions can be found in the GitHub repository. To learn more on radare2 you may want to read the official radare2 book ↗.

Install On Mac: 


```bash
brew install radare2
```



## Usage Tools

**Objection Usage**


# Show the different storage locations belonging to the app
```bash
OWASP.iGoat-Swift on (iPhone: 12.0) [usb] # env
```
# Disable popular ssl pinning methods
```bash
OWASP.iGoat-Swift on (iPhone: 12.0) [usb] # ios sslpinning disable
```
# Dump the Keychain
```bash
OWASP.iGoat-Swift on (iPhone: 12.0) [usb] # ios keychain dump
```
# Dump the Keychain, including access modifiers. The result will be written to the host in myfile.json
```bash
OWASP.iGoat-Swift on (iPhone: 12.0) [usb] # ios keychain dump --json <myfile.json>
```
# Show the content of a plist file
```bash
OWASP.iGoat-Swift on (iPhone: 12.0) [usb] # ios plist cat <myfile.plist>
```

```bash
OWASP.iGoat-Swift on (iPhone: 12.0) [usb] # ios hooking list classes
OWASP.iGoat-Swift on (iPhone: 12.0) [usb] # ios hooking list class_methods <ClassName>
OWASP.iGoat-Swift on (iPhone: 12.0) [usb] # ios bundles list_bundles
```


# Connecting to a patched IPA
```bash
$ objection explore
```
or 
```bash
$ objection -g <id process app> explore
```
# Using frida-ps to get the correct application name
```bash
$ frida-ps -Ua | grep -i Telegram
983  Telegram
```
*** Connecting to the Telegram app through Frida-server***
```bash
$ objection --gadget="Telegram" explore
```






